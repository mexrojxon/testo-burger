{% extends 'base.html' %}
{% load static %}
{% load i18n %}
{% load my_tags %}

{% block content %}
    <!-- PAGE CONTENT
    ============================================= -->
    <div id="page" class="page">


        <!-- PAGE HERO
        ============================================= -->
        <div id="cart-page" class="page-hero-section division">
            <div class="container">
                <div class="row">
                    <div class="col-lg-10 offset-lg-1">
                        <div class="hero-txt text-center white-color">

                            <!-- Breadcrumb -->
                            <div id="breadcrumb">
                                <div class="row">
                                    <div class="col">
                                        <div class="breadcrumb-nav">
                                            <nav aria-label="breadcrumb">
                                                <ol class="breadcrumb">
                                                    <li class="breadcrumb-item"><a
                                                            href="{% url 'pages:home' %}">Home</a></li>
                                                    <li class="breadcrumb-item active" aria-current="page">Shopping
                                                        Cart
                                                    </li>
                                                </ol>
                                            </nav>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Title -->
                            <h2 class="h2-xl">Shopping Cart</h2>

                        </div>
                    </div>
                </div>      <!-- End row -->
            </div>       <!-- End container -->
        </div>    <!-- END PAGE HERO -->


        <!-- CART PAGE
        ============================================= -->
        <section id="cart-1" class="wide-100 cart-page division">
            <div class="container">


                <!-- CART TABLE -->
                <div class="row">
                    <div class="col-md-12">
                        <div class="cart-table mb-70">
                            <table id="myTable">
                                <thead>
                                <tr>
                                    <th scope="col">Product</th>
                                    <th scope="col">Price</th>
                                    <th scope="col">Quantity</th>
                                    <th scope="col">Total</th>
                                    <th scope="col">Delete</th>
                                </tr>
                                </thead>

                                <tbody>
                                {{ object_list.count }}
                                {% for cart_item in object_list %}
                                    <tr {% if cart_item.id < cart_item.count %} class="last-tr" {% endif %}>
                                        <td data-label="Product" class="product-name">

                                            <!-- Preview -->
                                            <div class="cart-product-img"><img src="{{ cart_item.image.url }}"
                                                                               alt="cart-preview"></div>

                                            <!-- Description -->
                                            <div class="cart-product-desc">
                                                <h5 class="h5-sm">{{ cart_item.name }}</h5>
                                                <p class="p-sm">{{ cart_item.description }}</p>
                                            </div>

                                        </td>

                                        <td data-label="Price" class="product-price"><h5 class="h5-md">
                                            ${{ cart_item.price }}</h5></td>
                                        <td data-label="Quantity" class="product-qty">
                                            <input class="qty" type="number" min="1" max="20" value="1" method="POST">
                                        </td>
                                        <td data-label="Total" class="product-price-total"><h5 class="h5-md">$8.95</h5>
                                        </td>
                                        <td data-label="Delete" class="td-trash"><a
                                                href="{% url 'product:add_cart' cart_item.id %}?next={{ request.path }}"><i
                                                class="far fa-trash-alt"></i></a></td>

                                    </tr>
                                {% endfor %}
                                </tbody>

                            </table>
                        </div>
                    </div>
                </div>    <!-- END CART TABLE -->


                <!-- CART CHECKOUT -->
                <div class="row">

                    <!-- DISCOUNT COUPON -->
                    <div class="col-lg-8">
                        <div class="discount-coupon row pt-15">

                            <!-- Form -->
                            <div class="col-md-8 col-lg-7">
                                <form class="discount-form">

                                    <div class="input-group">
                                        <input type="text" class="form-control" placeholder="Coupon Code"
                                               id="discount-code">
                                        <span class="input-group-btn">
												<button type="submit" class="btn btn-salmon tra-salmon-hover">Apply Coupon</button>
											</span>
                                    </div>

                                </form>
                            </div>


                            <!-- Button -->
                            <div class="col-md-4 col-lg-5 text-right">
                                <a onClick="window.location.reload()" class="btn btn-md btn-salmon tra-salmon-hover">Update
                                    Cart</a>
                            </div>

                        </div>
                    </div>


                    <!-- CHECKOUT -->
                    <div class="col-lg-4">
                        <div class="cart-checkout bg-lightgrey">

                            <!-- Title -->
                            <h5 class="h5-lg">Cart Total</h5>

                            <!-- Table -->
                            <table>
                                <tbody>
                                <tr>
                                    <td>Subtotal</td>
                                    <td></td>
                                    <td class="text-right">$35.95</td>
                                </tr>
                                <tr class="last-tr">
                                    <td>Total</td>
                                    <td></td>
                                    {% get_cart_info request as cart_info %}
                                    <td class="text-right">${{ cart_info.1 }}</td>
                                </tr>
                                </tbody>
                            </table>

                            <!-- Button -->
                            <a href="#" data-toggle="modal" data-target="#staticBackdrop"
                               class="btn btn-md btn-salmon tra-salmon-hover">Proceed To Checkout</a>

                        </div>
                    </div>    <!-- END CHECKOUT -->


                </div>      <!-- END CART CHECKOUT -->


            </div>       <!-- End container -->
        </section>    <!-- END CART PAGE -->


        <!-- BANNER-3
        ============================================= -->
        <section id="banner-3" class="bg-yellow banner-section division">
            <div class="container">
                <div class="row d-flex align-items-center">


                    <!-- BANNER TEXT -->
                    <div class="col-md-7 col-lg-6">
                        <div class="banner-3-txt coffee-color">

                            <!-- Title  -->
                            <h4 class="h4-xl">Download mobile App and</h4>
                            <h2>save up to 20%</h2>

                            <!-- Text -->
                            <p class="p-md">Aliquam a augue suscipit, luctus neque purus ipsum and neque dolor primis
                                libero tempus,
                                blandit varius
                            </p>

                            <!-- Store Badges -->
                            <div class="stores-badge">

                                <!-- AppStore -->
                                <a href="#" class="store">
                                    <img class="appstore-original" src="{% static 'images/appstore.png' %}"
                                         alt="appstore-logo"/>
                                </a>

                                <!-- Google Play -->
                                <a href="#" class="store">
                                    <img class="googleplay-original" src="{% static 'images/googleplay.png' %}"
                                         alt="googleplay-logo"/>
                                </a>

                            </div>

                        </div>
                    </div>


                    <!-- BANNER IMAGE -->
                    <div class="col-md-5 col-lg-6">
                        <div class="banner-3-img">
                            <img class="img-fluid" src="{% static 'images/e-shop.png' %}" alt="banner-image">
                        </div>
                    </div>


                </div>      <!-- End row -->
            </div>        <!-- End container -->
        </section>    <!-- END BANNER-3 -->
    </div>    <!-- END PAGE CONTENT -->

    <div class="modal fade" id="staticBackdrop" data-backdrop="static" data-keyboard="false" tabindex="-1"
         aria-labelledby="staticBackdropLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="staticBackdropLabel">Confirm the order</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="col-md-2 col-lg-12">
                        <form class="discount-form">
                            <input type="text" class="form-control mb-2" placeholder="What is your name?"
                                   id="discount-code">
                            <div class="input-group">

                                <input type="text" class="form-control" placeholder="Please enter phone number"
                                       id="discount-code">
                                <span class="input-group-btn">
												<button type="submit"
                                                        class="btn btn-salmon tra-salmon-hover">SEND SMS</button>
											</span>
                            </div>

                        </form>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-md btn-salmon tra-salmon-hover" data-dismiss="modal">Close
                    </button>
                    <button type="button" class="btn btn-md btn-salmon tra-salmon-hover">CONFIRM</button>
                </div>
            </div>
        </div>
    </div>

{% endblock %}

{% block extra_js %}
    <script>
        function getParamSearch(name, value) {
            var searchParams = new URLSearchParams(window.location.search);
            if (searchParams.has(name) && searchParams.get(name) == value) {
                searchParams.delete(name);
            } else {
                searchParams.set(name, value);
            }
            window.location.search = searchParams.toString();
        }
    </script>
{% endblock %}